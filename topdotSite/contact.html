<!doctype html>
<html>
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BL7SMMJKEG"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-BL7SMMJKEG');
    </script>
	<link href="css/base.css" rel="stylesheet" type="text/css">
	<link href="css/layout.css" rel="stylesheet" type="text/css">
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>topdot architects</title>
	<link rel="icon" type="image/x-icon" href="images/favicon.ico">
	<script src="https://use.edgefonts.net/montserrat:n4:default;source-sans-pro:n2:default.js" type="text/javascript"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
	
	<script>	
      let pageName = "Contact";
    </script>	
	
	<div id="mainwrapper">	
		<?php
		$__dir = __DIR__;
		while (!file_exists($__dir . "/partials/header.php")) {
			$__parent = dirname($__dir);
			if ($__parent === $__dir) break;
			$__dir = $__parent;
		}
		include $__dir . "/partials/header.php";
		?>

		<div id="content">
		  <div id="form-container">	
			  <div class="contactContainerHeader"> 
				  <h3>Contact Form</h3>			  
			  </div>
			  <div class="contactForm">
				  <script src="https://www.cognitoforms.com/f/seamless.js" data-key="bLmd7UDw4kSJZmpzKJO3cg" data-form="2"></script>
			  </div>			  
		  </div>

		  <div id="contact-info" class="contact-info">			  
			  <div class="contactContainerHeader">
				  <h3>Contact Info</h3>
			  </div>
			<div class="contact-item">
			  <label>Email:</label>
			  <a href="mailto:info@topdot.ca">info@topdot.ca</a>
			</div>
			<div class="contact-item">
			  <label>Phone:</label>
			  <a href="tel:6479268269">647.926.8269</a>
			</div>
		  </div>	
		</div>

		<?php
		$__dir = __DIR__;
		while (!file_exists($__dir . "/partials/footer.php")) {
			$__parent = dirname($__dir);
			if ($__parent === $__dir) break;
			$__dir = $__parent;
		}
		include $__dir . "/partials/footer.php";
		?>
	</div>

	<script>
		// Contact form handler (legacy)
		// This page now embeds a Cognito form. The old custom form elements
		// (#contact-form, #submit-btn, etc.) may not exist, so we guard against null.
        const form = document.querySelector('#contact-form');
        const submitBtn = document.querySelector('#submit-btn');

		// If the legacy form isn't on this page, do nothing.
		if (!form || !submitBtn) {
			// Exit early so we don't throw errors in the console.
			// (The Cognito form still works independently.)
		} else {

        form.addEventListener('submit', (e) => {
          e.preventDefault();

          // Validate math question
          const mathInput = document.querySelector('#math');
          if (mathInput.value !== '5') {
            alert('Incorrect answer to the math question!');
            mathInput.focus();
            return;
          }

          // Prepare email message
          const firstName = document.querySelector('#firstname').value;
          const lastName = document.querySelector('#lastname').value;
          const email = document.querySelector('#email').value;
          const phone = document.querySelector('#phone').value;
          const message = document.querySelector('#message').value;
          const emailBody = `Name: ${firstName} ${lastName}\nEmail: ${email}\nPhone: ${phone}\nMessage: ${message}`;

          // Send email message
          const xhr = new XMLHttpRequest();
          xhr.open('POST', 'send-email.php');
          xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
          xhr.onload = function() {
            if (xhr.status === 200) {
              alert('Email sent successfully!');
            } else {
              alert('There was an error sending the email. Please try again later.');
            }
          };
          xhr.send(`emailBody=${encodeURIComponent(emailBody)}`);

          // Clear form
          form.reset();
        });

		}
	</script>

<script src="js/pageName.js" defer></script>

<script src="js/nav.js" defer></script>

</body>
</html>
